<div id="page-content">
    <h1 class="text-center mt-4"><%= @user.email.split("@")[0].capitalize %> 's Profile</h1>
    <div class="container">
        <div class="row justify-content-md-center" >
            <div class="card" style="width: 25rem;">
                <% if @user.avatar.attached? %>
                    <%= image_tag(@user.avatar_thumbnail) %>
                <% else %>    
                    <%= image_tag("defualt.png", style:'width:30%') %>
                <% end %>

                <div class="card-body">
                    <h5 class="card-title">Total Posts : <%= @user.posts.count %></h5>
                    <% @user.posts.each do |post| %>
                        <%= link_to post.title, post_path(post) %><br/>
                    <% end %>    
                    <br/>
                    <% if @user==current_user %>
                        <%= link_to 'Edit Profile', edit_user_registration_path, class:"btn btn-outline-primary" %>
                    <% end %>  
            
                    <% if @user!=current_user %>
                    
                    <%= form_with scope: :friend, url: friends_path, local: true do |f|%>
    
    
                        <div class="form-group row justify-content-center">
        
                            <div class="form-group row">
                                <div class="col-10">
                                    <%= f.number_field :user_id, id: :friend_user_id, class:"form-control", value: @user.id, type: :hidden%>
                                </div>   
                            </div>
                            <div class="form-group row">
                                <div class="col-10">
                                    <%= f.number_field :receiver_id, class:"form-control", value: current_user.id, type: :hidden %>
                                </div>   
                            </div>

                            <div class="form-group row">
                                <div class="col-10">
                                    <%= f.text_field :status,rows:3, class:"form-control shadow-sm bg-white rounded",value:"pending", type: :hidden %>
                                </div>   
                            </div>
                        </div>
        
                        
                        
                        <% @friends=@user.friends %>
                        <% @companion=current_user.companions %>
                        <% if @companion.exists?(buddy: @user) %>
                            <span class="badge badge-success"> friend</span> 
                        <% elsif !@friends.exists?(user_id: @user) %>
                            <div class="form-group row justify-content-center">
                                <%= f.submit "Send friend Request", class:"btn btn-primary btn-lg" %>
                            </div>
                        <% else %>
                            <span class="badge badge-warning"> pending....</span> 
                        <% end %>  
                        
        
                    <% end %>

                    <% end %>


                </div>
            </div>  
            

    



        </div>  
    </div>
</div>